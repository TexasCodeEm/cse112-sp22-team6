import{isA11yEnabled}from"../accessibility.js";import{ZEROS}from"./storage.js";const X_LABELS=["M","T","W","Th","F","Sa","Su"],Y_LABEL="Pomos Completed",INITIAL_Y_AXES=[0,1,2,3],TEXT_ALIGN_CENTER="center",TEXT_FONT="12px Roboto",TEXT_FONT_ACCESSIBILITY="bold 15px Roboto",BAR_COLOR="#eb4000",BAR_COLOR_ACCESSIBILITY="#B50014",BAR_WIDTH=20,BAR_PADDING=12,BAR_LEFT_MARGIN=24,TEXT_HEIGHT=14,TOP_PADDING=16,RIGHT_PADDING=16,BOTTOM_PADDING=32,LEFT_PADDING=48,FILL_TEXT_X_PAD=16,FILL_TEXT_Y_PAD=4,X_LABEL_HEIGHT_PAD=8,Y_MIN_SPACING=3,Y_MAX_SPACING=11,TWO=2,TEST_PROCESS="test",CONTEXT_2D="2d";function drawGraph(_,T=ZEROS){if(_&&("object"!=typeof process||process.env.NODE_ENV!==TEST_PROCESS)){const I=_.getContext(CONTEXT_2D);var A=calculateAxes(T);I.clearRect(0,0,_.width,_.height),drawAxes(I,_.height,_.width,A),drawBars(I,_.height,T,A),I.save()}}function drawAxes(_,T,A,I){var e,t,r,E,D=T-BOTTOM_PADDING,a=A-RIGHT_PADDING;_.font=isA11yEnabled()?TEXT_FONT_ACCESSIBILITY:TEXT_FONT,_.textAlign=TEXT_ALIGN_CENTER;for([e,t]of I.entries()){var o=LEFT_PADDING,N=TOP_PADDING+D-Math.round(D*(e/(I.length-1)));drawLine(_,o,N,a,N),_.fillText(t,o-FILL_TEXT_X_PAD,N+FILL_TEXT_Y_PAD)}_.save(),_.translate(16,Math.round((TOP_PADDING+D)/TWO)),_.rotate(-Math.PI/TWO),_.fillText(Y_LABEL,0,0),_.restore();for([r,E]of X_LABELS.entries()){var L=LEFT_PADDING+BAR_LEFT_MARGIN+r*(BAR_WIDTH+BAR_PADDING),P=TOP_PADDING+D+X_LABEL_HEIGHT_PAD+TEXT_HEIGHT/TWO;_.fillText(E,L,P)}drawLine(_,LEFT_PADDING,0,LEFT_PADDING,TOP_PADDING+D)}function calculateAxes(_){const T=INITIAL_Y_AXES.slice();let A=Math.max(..._);if(A<Y_MIN_SPACING)return T;for(A>=Y_MAX_SPACING&&A++,A++;A%Y_MIN_SPACING!=0;)A++;_=1;return T[_++]=A/Y_MIN_SPACING,T[+_]=TWO*A/Y_MIN_SPACING,T[3]=A,T}function drawBars(_,T,A,I){var e,t,r=Math.max(...I),E=T-BOTTOM_PADDING;for([e,t]of A.entries()){var D,a=Math.round(E*(t/r));0<a&&(D=isA11yEnabled()?BAR_COLOR_ACCESSIBILITY:BAR_COLOR,drawBar(_,LEFT_PADDING+BAR_LEFT_MARGIN+e*(BAR_WIDTH+BAR_PADDING),TOP_PADDING+E-a,BAR_WIDTH,a,D))}}function drawBar(_,T,A,I,e,t){_.save(),_.fillStyle=t,_.fillRect(T-Math.round(I/TWO),A,I,e),_.restore()}function drawLine(_,T,A,I,e){_.beginPath(),_.moveTo(T,A),_.lineTo(I,e),_.stroke()}export{drawGraph,calculateAxes};